# å›½é™…åŒ– (i18n) æŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜äº† iDO é¡¹ç›®çš„å›½é™…åŒ–ç³»ç»Ÿã€å¦‚ä½•æ·»åŠ æ–°è¯­è¨€ã€ä»¥åŠå¦‚ä½•åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ç¿»è¯‘ã€‚

## ç›®å½•

- [æ¦‚è§ˆ](#æ¦‚è§ˆ)
- [é¡¹ç›®é…ç½®](#é¡¹ç›®é…ç½®)
- [æ·»åŠ ç¿»è¯‘](#æ·»åŠ ç¿»è¯‘)
- [åœ¨ç»„ä»¶ä¸­ä½¿ç”¨](#åœ¨ç»„ä»¶ä¸­ä½¿ç”¨)
- [éªŒè¯ç¿»è¯‘](#éªŒè¯ç¿»è¯‘)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

## æ¦‚è§ˆ

iDO ä½¿ç”¨**ç±»å‹å®‰å…¨çš„ TypeScript é¦–å…ˆ i18n ç³»ç»Ÿ**ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- âœ… **å®Œå…¨ç±»å‹å®‰å…¨**ï¼šæ‰€æœ‰ç¿»è¯‘é”®åœ¨ç¼–è¯‘æ—¶æ£€æŸ¥
- âœ… **æ— è¿è¡Œæ—¶å¼€é”€**ï¼šç¿»è¯‘å­—ç¬¦ä¸²ç›´æ¥ç¼–è¯‘åˆ°ä»£ç ä¸­
- âœ… **è‡ªåŠ¨éªŒè¯**ï¼šç¡®ä¿æ‰€æœ‰è¯­è¨€æœ‰ä¸€è‡´çš„é”®
- âœ… **æ˜“äºç»´æŠ¤**ï¼šè‹±æ–‡æ–‡ä»¶æ˜¯æºæ–‡ä»¶ï¼Œå…¶ä»–è¯­è¨€ä¸ä¹‹åŒæ­¥

### å·¥ä½œæµç¨‹

```
src/locales/en.ts (English - Source)
         â†“
    å®šä¹‰æ‰€æœ‰é”®å’Œç±»å‹
         â†“
pnpm check-i18n éªŒè¯
         â†“
src/locales/zh-CN.ts (Chinese)
src/locales/ja-JP.ts (Japanese - å¯æ·»åŠ )
         â†“
    åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
```

## é¡¹ç›®é…ç½®

### æ–‡ä»¶ç»“æ„

```
src/locales/
â”œâ”€â”€ en.ts                # è‹±æ–‡ï¼ˆæºæ–‡ä»¶ï¼Œå®šä¹‰ç»“æ„ï¼‰
â”œâ”€â”€ zh-CN.ts            # ä¸­æ–‡ç®€ä½“
â””â”€â”€ index.ts            # å¯¼å‡º
```

### ç¿»è¯‘æ–‡ä»¶æ ¼å¼

#### è‹±æ–‡æºæ–‡ä»¶ï¼ˆen.tsï¼‰

```typescript
// src/locales/en.ts
export const en = {
  // èœå•å’Œå¯¼èˆª
  sidebar: {
    activity: 'Activity',
    dashboard: 'Dashboard',
    agents: 'Agents',
    settings: 'Settings',
  },

  // æ´»åŠ¨åŠŸèƒ½
  activity: {
    title: 'Activity Timeline',
    description: 'View your work activities',
    empty: 'No activities yet',
    filter: 'Filter activities',
    search: 'Search',
  },

  // Agent åŠŸèƒ½
  agents: {
    title: 'Tasks',
    noTasks: 'No tasks yet',
    createTask: 'Create Task',
    status: {
      todo: 'To Do',
      doing: 'In Progress',
      done: 'Done',
      cancelled: 'Cancelled',
    },
  },

  // è®¾ç½®é¡µé¢
  settings: {
    title: 'Settings',
    general: 'General Settings',
    llm: 'LLM Configuration',
    apiKey: 'API Key',
    model: 'Model',
    language: 'Language',
    theme: 'Theme',
  },

  // é€šç”¨é”™è¯¯å’Œæ¶ˆæ¯
  common: {
    save: 'Save',
    cancel: 'Cancel',
    delete: 'Delete',
    edit: 'Edit',
    loading: 'Loading...',
    error: 'Error',
    success: 'Success',
  },

  errors: {
    loadFailed: 'Failed to load data',
    saveFailed: 'Failed to save changes',
    connectionError: 'Connection error',
    invalidInput: 'Invalid input',
  },
} as const
```

#### ä¸­æ–‡ç¿»è¯‘ï¼ˆzh-CN.tsï¼‰

```typescript
// src/locales/zh-CN.ts
export const zhCN = {
  // èœå•å’Œå¯¼èˆª
  sidebar: {
    activity: 'æ´»åŠ¨',
    dashboard: 'ä»ªè¡¨æ¿',
    agents: 'ä»»åŠ¡',
    settings: 'è®¾ç½®',
  },

  // æ´»åŠ¨åŠŸèƒ½
  activity: {
    title: 'æ´»åŠ¨æ—¶é—´çº¿',
    description: 'æŸ¥çœ‹ä½ çš„å·¥ä½œæ´»åŠ¨',
    empty: 'æš‚æ— æ´»åŠ¨',
    filter: 'ç­›é€‰æ´»åŠ¨',
    search: 'æœç´¢',
  },

  // Agent åŠŸèƒ½
  agents: {
    title: 'ä»»åŠ¡',
    noTasks: 'æš‚æ— ä»»åŠ¡',
    createTask: 'åˆ›å»ºä»»åŠ¡',
    status: {
      todo: 'å¾…åš',
      doing: 'è¿›è¡Œä¸­',
      done: 'å·²å®Œæˆ',
      cancelled: 'å·²å–æ¶ˆ',
    },
  },

  // è®¾ç½®é¡µé¢
  settings: {
    title: 'è®¾ç½®',
    general: 'é€šç”¨è®¾ç½®',
    llm: 'LLM é…ç½®',
    apiKey: 'API Key',
    model: 'æ¨¡å‹',
    language: 'è¯­è¨€',
    theme: 'ä¸»é¢˜',
  },

  // é€šç”¨é”™è¯¯å’Œæ¶ˆæ¯
  common: {
    save: 'ä¿å­˜',
    cancel: 'å–æ¶ˆ',
    delete: 'åˆ é™¤',
    edit: 'ç¼–è¾‘',
    loading: 'åŠ è½½ä¸­...',
    error: 'é”™è¯¯',
    success: 'æˆåŠŸ',
  },

  errors: {
    loadFailed: 'åŠ è½½æ•°æ®å¤±è´¥',
    saveFailed: 'ä¿å­˜æ›´æ”¹å¤±è´¥',
    connectionError: 'è¿æ¥é”™è¯¯',
    invalidInput: 'è¾“å…¥æ— æ•ˆ',
  },
}
```

#### å¯¼å‡ºæ–‡ä»¶ï¼ˆindex.tsï¼‰

```typescript
// src/locales/index.ts
import { en } from './en'
import { zhCN } from './zh-CN'

export const locales = {
  en,
  'zh-CN': zhCN,
}

export type Locale = keyof typeof locales
export type TranslationKey = keyof typeof en
```

## æ·»åŠ ç¿»è¯‘

### æ­¥éª¤ 1ï¼šæ·»åŠ è‹±æ–‡é”®

ç¼–è¾‘ `src/locales/en.ts`ï¼Œåœ¨é€‚å½“çš„ä½ç½®æ·»åŠ æ–°é”®ï¼š

```typescript
export const en = {
  myFeature: {
    title: 'My Feature',
    description: 'Feature description',
    button: 'Click me',
  },
} as const
```

### æ­¥éª¤ 2ï¼šæ·»åŠ å¯¹åº”çš„ä¸­æ–‡ç¿»è¯‘

ç¼–è¾‘ `src/locales/zh-CN.ts`ï¼Œ**å¿…é¡»ä¿æŒé”®çš„ç»“æ„å’Œåç§°å®Œå…¨ç›¸åŒ**ï¼š

```typescript
export const zhCN = {
  myFeature: {
    title: 'æˆ‘çš„åŠŸèƒ½',
    description: 'åŠŸèƒ½æè¿°',
    button: 'ç‚¹å‡»æˆ‘',
  },
}
```

### æ­¥éª¤ 3ï¼šéªŒè¯ç¿»è¯‘

```bash
# æ£€æŸ¥æ‰€æœ‰è¯­è¨€æ˜¯å¦æœ‰ä¸€è‡´çš„é”®
pnpm check-i18n
```

å¦‚æœæœ‰é—æ¼ï¼Œä¼šçœ‹åˆ°ç±»ä¼¼çš„é”™è¯¯ï¼š

```
âŒ Missing in zh-CN.ts:
  - myFeature.title
  - myFeature.button

âŒ Extra keys in zh-CN.ts:
  - oldFeature.title
```

### æ­¥éª¤ 4ï¼šä¿®å¤é”™è¯¯

æ ¹æ®é”™è¯¯æç¤ºï¼Œæ·»åŠ é—æ¼çš„ç¿»è¯‘æˆ–åˆ é™¤å¤šä½™çš„ç¿»è¯‘ã€‚

## åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

### åŸºç¡€ä½¿ç”¨

ä½¿ç”¨ `useTranslation` hook è·å–ç¿»è¯‘å‡½æ•°ï¼š

```typescript
import { useTranslation } from '@/hooks/useTranslation'

export function MyComponent() {
  const { t } = useTranslation()

  return (
    <div>
      <h1>{t('myFeature.title')}</h1>
      <p>{t('myFeature.description')}</p>
      <button>{t('myFeature.button')}</button>
    </div>
  )
}
```

### å®Œæ•´çš„ç»„ä»¶ç¤ºä¾‹

```typescript
// src/views/Settings/index.tsx
import { useTranslation } from '@/hooks/useTranslation'
import { useSettingsStore } from '@/lib/stores'

export function SettingsView() {
  const { t } = useTranslation()
  const language = useSettingsStore((state) => state.language)
  const updateLanguage = useSettingsStore((state) => state.updateLanguage)

  return (
    <div>
      <h1>{t('settings.title')}</h1>

      <section>
        <h2>{t('settings.general')}</h2>
        <label>{t('settings.language')}</label>
        <select value={language} onChange={(e) => updateLanguage(e.target.value)}>
          <option value="en">English</option>
          <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
        </select>
      </section>

      <section>
        <h2>{t('settings.llm')}</h2>
        <label>{t('settings.apiKey')}</label>
        <input type="password" placeholder={t('settings.apiKey')} />
      </section>
    </div>
  )
}
```

### åŠ¨æ€ç¿»è¯‘

æŸäº›æƒ…å†µä¸‹éœ€è¦åŠ¨æ€ç”Ÿæˆç¿»è¯‘é”®ï¼š

```typescript
import { locales } from '@/locales'

export function TaskStatusBadge({ status }: { status: 'todo' | 'doing' | 'done' }) {
  const { t } = useTranslation()

  // âœ… å®‰å…¨çš„åŠ¨æ€ç¿»è¯‘
  const key = `agents.status.${status}`
  const translated = t(key as any) // æ³¨æ„ï¼šéœ€è¦ç±»å‹æ–­è¨€

  return <span>{translated}</span>
}

// æˆ–è€…é¢„å…ˆå®šä¹‰æ‰€æœ‰çŠ¶æ€
const statusLabels = {
  todo: 'agents.status.todo',
  doing: 'agents.status.doing',
  done: 'agents.status.done',
} as const

export function TaskStatusBadge({ status }) {
  const { t } = useTranslation()
  return <span>{t(statusLabels[status])}</span>
}
```

### åœ¨å±æ€§ä¸­ä½¿ç”¨

```typescript
export function Button() {
  const { t } = useTranslation()

  return (
    <button
      title={t('common.save')}
      placeholder={t('activity.search')}
      aria-label={t('sidebar.activity')}
    >
      {t('common.save')}
    </button>
  )
}
```

## éªŒè¯ç¿»è¯‘

### è‡ªåŠ¨éªŒè¯

```bash
# æ£€æŸ¥æ‰€æœ‰ç¿»è¯‘çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§
pnpm check-i18n
```

### éªŒè¯è„šæœ¬åŸç†

éªŒè¯è„šæœ¬æ£€æŸ¥ï¼š
1. âœ… æ‰€æœ‰è¯­è¨€éƒ½æœ‰è‹±æ–‡æ–‡ä»¶çš„æ‰€æœ‰é”®
2. âœ… æ²¡æœ‰å¤šä½™çš„é”®ï¼ˆåœ¨è‹±æ–‡ä¸­ä¸å­˜åœ¨ï¼‰
3. âœ… é”®çš„åµŒå¥—ç»“æ„å®Œå…¨ç›¸åŒ

### å¸¸è§éªŒè¯é”™è¯¯

#### é”™è¯¯ 1ï¼šé—æ¼ç¿»è¯‘

```
âŒ Missing in zh-CN.ts:
  - activity.newField
```

**è§£å†³ï¼š** åœ¨ `zh-CN.ts` ä¸­æ·»åŠ é—æ¼çš„é”®

```typescript
activity: {
  newField: 'æ–°å­—æ®µ',
}
```

#### é”™è¯¯ 2ï¼šå¤šä½™çš„é”®

```
âŒ Extra keys in zh-CN.ts:
  - oldFeature.title
```

**è§£å†³ï¼š** åˆ é™¤åœ¨è‹±æ–‡æ–‡ä»¶ä¸­ä¸å­˜åœ¨çš„é”®

```typescript
// åˆ é™¤è¿™ä¸€è¡Œ
// oldFeature: { title: '...' }
```

#### é”™è¯¯ 3ï¼šåµŒå¥—ç»“æ„ä¸åŒ

```
âŒ Structure mismatch at settings:
  English: { llm: { apiKey: '...' } }
  zh-CN: { llmConfig: { apiKey: '...' } }
```

**è§£å†³ï¼š** ç¡®ä¿é”®çš„åç§°å®Œå…¨ç›¸åŒ

```typescript
// âŒ é”™è¯¯
settings: {
  llmConfig: { ... }
}

// âœ… æ­£ç¡®
settings: {
  llm: { ... }
}
```

## æœ€ä½³å®è·µ

### âœ… ç»„ç»‡ç»“æ„

æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡ç¿»è¯‘é”®ï¼š

```typescript
export const en = {
  // å¯¼èˆªå’Œèœå•
  sidebar: { ... },
  navigation: { ... },

  // åŠŸèƒ½æ¨¡å—
  activity: { ... },
  agents: { ... },
  dashboard: { ... },
  settings: { ... },

  // é€šç”¨
  common: { ... },
  errors: { ... },
}
```

### âœ… å‘½åè§„èŒƒ

- ä½¿ç”¨å°é©¼å³°å‘½åï¼š`myFeatureName`
- åµŒå¥—çš„é”®ç”¨ç‚¹å·åˆ†éš”ï¼š`activity.emptyState.message`
- å°½å¯èƒ½ç®€æ´å’Œè‡ªæè¿°

### âœ… é¿å…ç¡¬ç¼–ç 

âŒ **ä¸å¥½**ï¼š
```typescript
<h1>Activity Timeline</h1>
```

âœ… **å¥½**ï¼š
```typescript
const { t } = useTranslation()
<h1>{t('activity.title')}</h1>
```

### âœ… é•¿æ–‡æœ¬å¤„ç†

å¯¹äºé•¿çš„æè¿°æˆ–å¸®åŠ©æ–‡æœ¬ï¼Œå¯ä»¥ä½¿ç”¨å¤šè¡Œå­—ç¬¦ä¸²ï¼š

```typescript
export const en = {
  help: {
    apiKey: `Enter your OpenAI API key here.
You can find it in your account settings.
This is required to enable AI features.`,
  },
}
```

### âœ… ä¿ç•™ç‰¹æ®Šå­—ç¬¦

å¦‚æœç¿»è¯‘ä¸­åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œä½¿ç”¨è½¬ä¹‰ï¼š

```typescript
export const en = {
  special: {
    copyright: 'Â© 2024 Texas',
    trademark: 'â„¢',
    quote: '"Hello World"',
  },
}
```

### âœ… æ—¥æœŸå’Œæ•°å­—æ ¼å¼

ä½¿ç”¨ `date-fns` å’Œ `Intl` API æ¥æ ¼å¼åŒ–æ—¥æœŸå’Œæ•°å­—ï¼š

```typescript
import { format } from 'date-fns'
import { zhCN as dateZhCN } from 'date-fns/locale'

function formatDate(date: Date, locale: string) {
  const localeMap = {
    en: undefined,
    'zh-CN': dateZhCN,
  }

  return format(date, 'PPP p', { locale: localeMap[locale] })
}
```

## æ·»åŠ æ–°è¯­è¨€

### æ­¥éª¤ 1ï¼šåˆ›å»ºæ–°çš„è¯­è¨€æ–‡ä»¶

```typescript
// src/locales/ja-JP.ts
export const jaJP = {
  sidebar: {
    activity: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£',
    dashboard: 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',
    agents: 'ã‚¿ã‚¹ã‚¯',
    settings: 'è¨­å®š',
  },
  // ... å®Œæ•´å†…å®¹
}
```

### æ­¥éª¤ 2ï¼šæ›´æ–°å¯¼å‡º

```typescript
// src/locales/index.ts
import { en } from './en'
import { zhCN } from './zh-CN'
import { jaJP } from './ja-JP'

export const locales = {
  en,
  'zh-CN': zhCN,
  'ja-JP': jaJP,
}
```

### æ­¥éª¤ 3ï¼šéªŒè¯

```bash
pnpm check-i18n
```

### æ­¥éª¤ 4ï¼šæ›´æ–°è®¾ç½®

åœ¨è®¾ç½®é¡µé¢æ·»åŠ æ–°è¯­è¨€é€‰é¡¹ï¼š

```typescript
// src/components/Settings/LanguageSelect.tsx
<select>
  <option value="en">English</option>
  <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
  <option value="ja-JP">æ—¥æœ¬èª</option>
</select>
```

## è·å–å¸®åŠ©

- ğŸ“– æŸ¥çœ‹ [å¼€å‘æŒ‡å—](./development.md)
- ğŸ› æŠ¥å‘Š Bugï¼š[GitHub Issues](https://github.com/TexasOct/iDO/issues)
